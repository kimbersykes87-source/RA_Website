# Google Sheets Setup for Rubber Armstrong 2026

This document describes the Google Sheets structure required for the Statement of Intent (SOI) form submissions and approval workflow.

## Overview

The Google Sheets workbook serves as the database for all SOI submissions. It tracks submissions through a manual review process from initial submission to approval/rejection.

## Sheet Tabs Required

Create a Google Sheet with the following four tabs:

1. **SOI_Staging** - All new submissions (default Status: "Pending")
2. **SOI_Approved** - Approved applicants
3. **SOI_Rejected** - Rejected applicants
4. **SOI_2026** - End-of-season archive

## Column Structure

All tabs should have the same column structure for consistency.

### Column Order and Names

| # | Column Name | Type | Description |
|---|------------|------|-------------|
| 1 | Timestamp | DateTime | Auto-generated by Apps Script when form is submitted |
| 2 | Full Name | Text | Applicant's full legal name |
| 3 | Preferred Name | Text | Preferred or playa name (optional) |
| 4 | Email | Email | Primary contact email |
| 5 | WhatsApp Number | Text | WhatsApp contact with country code (optional) |
| 6 | Country | Text | Country of residence (optional) |
| 7 | Closest City | Text | Closest major city (optional) |
| 8 | Pronouns | Text | Personal pronouns (optional) |
| 9 | Why RA | Long Text | What about Rubber Armstrong resonates with you |
| 10 | Values | Long Text | Which values speak to you most and why |
| 11 | Contribution | Long Text | What you think you could bring to RA community |
| 12 | Working Camp | Choice | Response to "RA is a working camp" question |
| 13 | How Heard | Choice | How they heard about Rubber Armstrong |
| 14 | Hear More | Text | Additional context for "How Heard" (optional) |
| 15 | Access Needs | Long Text | Access or support needs (optional) |
| 16 | Status | Text | Pending / Approved / Rejected |
| 17 | Reviewed By | Text | Name of person who reviewed (manual) |
| 18 | Reviewed At | DateTime | Date/time of review (manual) |
| 19 | Internal Notes | Long Text | Private notes about applicant (manual) |

### Column Formatting

**Header Row (Row 1)**:
- Bold text
- Background color: Light gray (#f3f3f3)
- Frozen (freeze first row for scrolling)

**Data Validation**:
- **Status** (Column 16): Data validation dropdown with values: "Pending", "Approved", "Rejected"
- **Working Camp** (Column 12): Matches form options
- **How Heard** (Column 13): Matches form options

**Conditional Formatting**:
- Status = "Pending": Light yellow background (#fff3cd)
- Status = "Approved": Light green background (#d4edda)
- Status = "Rejected": Light red background (#f8d7da)

## Tab Descriptions

### 1. SOI_Staging

**Purpose**: All form submissions land here with Status = "Pending"

**Workflow**:
1. New submissions automatically added by Apps Script
2. Review team regularly checks this tab
3. For each entry:
   - Read through responses
   - Update Status to "Approved" or "Rejected"
   - Add Reviewed By (your name)
   - Add Reviewed At (current date/time)
   - Optionally add Internal Notes
4. Copy entire row to SOI_Approved or SOI_Rejected tab
5. Leave original row in SOI_Staging for record-keeping

**Filtering**:
- Create filter view showing only Status = "Pending"
- Sort by Timestamp (oldest first) to review in order

### 2. SOI_Approved

**Purpose**: Clean list of approved applicants

**Workflow**:
1. Manually copy approved rows from SOI_Staging
2. This tab represents current approved applicants
3. Use this list to:
   - Send "I Want to Join" form links (after ticket sales)
   - Track approved applicants
   - Generate statistics

**Notes**:
- Only entries with Status = "Approved"
- Copy entire row including all review metadata

### 3. SOI_Rejected

**Purpose**: Record of declined applicants

**Workflow**:
1. Manually copy rejected rows from SOI_Staging
2. Helps avoid re-reviewing if someone submits multiple times
3. Provides record for questions or appeals

**Notes**:
- Only entries with Status = "Rejected"
- Keep Internal Notes respectful and constructive
- This data should be kept confidential

### 4. SOI_2026

**Purpose**: End-of-season archive of all 2026 submissions

**Workflow**:
1. At end of season (Sept/Oct 2026):
   - Copy all rows from SOI_Staging
   - Copy all rows from SOI_Approved (if not already in Staging)
   - Copy all rows from SOI_Rejected (if not already in Staging)
2. This creates a complete historical record
3. Can be used for year-over-year comparisons

**Notes**:
- Only populated at end of season
- Complete archive of all submissions regardless of status

## Google Apps Script Setup

### Script Purpose
Receives POST requests from the SOI form and writes data to SOI_Staging sheet.

### Script Code (Example)

```javascript
function doPost(e) {
  try {
    // Parse incoming JSON
    const data = JSON.parse(e.postData.contents);
    
    // Open the spreadsheet and get SOI_Staging sheet
    const ss = SpreadsheetApp.getActiveSpreadsheet();
    const sheet = ss.getSheetByName('SOI_Staging');
    
    // Prepare row data (must match column order)
    const row = [
      new Date(),                    // Timestamp
      data.fullName || '',           // Full Name
      data.preferredName || '',      // Preferred Name
      data.email || '',              // Email
      data.whatsapp || '',           // WhatsApp Number
      data.country || '',            // Country
      data.city || '',               // Closest City
      data.pronouns || '',           // Pronouns
      data.whyRA || '',              // Why RA
      data.values || '',             // Values
      data.contribution || '',       // Contribution
      data.workingCamp || '',        // Working Camp
      data.howHeard || '',           // How Heard
      data.hearMore || '',           // Hear More
      data.accessNeeds || '',        // Access Needs
      'Pending',                     // Status (default)
      '',                            // Reviewed By (empty initially)
      '',                            // Reviewed At (empty initially)
      ''                             // Internal Notes (empty initially)
    ];
    
    // Append row to sheet
    sheet.appendRow(row);
    
    // Return success response
    return ContentService
      .createTextOutput(JSON.stringify({ 
        status: 'success',
        message: 'Submission received'
      }))
      .setMimeType(ContentService.MimeType.JSON);
      
  } catch (error) {
    // Return error response
    return ContentService
      .createTextOutput(JSON.stringify({ 
        status: 'error',
        message: error.toString()
      }))
      .setMimeType(ContentService.MimeType.JSON);
  }
}
```

### Script Deployment

1. Open your Google Sheet
2. Go to **Extensions → Apps Script**
3. Delete any existing code
4. Paste the script above
5. Modify field mappings if your form fields differ
6. Click **Deploy → New Deployment**
7. Select **Web app** as deployment type
8. Settings:
   - **Execute as**: Me (your account)
   - **Who has access**: Anyone
9. Click **Deploy**
10. Copy the web app URL
11. Update `soi-site/js/config.js` with this URL

### Testing the Script

1. Use Postman or curl to send test POST request:
```bash
curl -X POST "YOUR_SCRIPT_URL" \
  -H "Content-Type: application/json" \
  -d '{"fullName":"Test User","email":"test@example.com","whyRA":"Testing","values":"Testing","contribution":"Testing","workingCamp":"fully-aligned","howHeard":"online-research","status":"Pending"}'
```

2. Check SOI_Staging tab for new row
3. Verify all fields populated correctly

## Manual Approval Workflow

### Step-by-Step Process

**1. Open SOI_Staging Tab**
   - Filter to show Status = "Pending"
   - Sort by Timestamp (oldest first)

**2. Review Each Submission**
   - Read all text responses carefully
   - Consider:
     - Values alignment (most important)
     - Understanding of working camp concept
     - Thoughtfulness of responses
     - Fit with RA community culture
   - Make decision: Approve or Reject

**3. Update Status**
   - Change Status column to "Approved" or "Rejected"
   - Enter your name in Reviewed By
   - Enter current date/time in Reviewed At
   - Add Internal Notes if needed

**4. Copy to Appropriate Tab**
   - **If Approved**: Copy entire row to SOI_Approved tab
   - **If Rejected**: Copy entire row to SOI_Rejected tab
   - Keep original row in SOI_Staging

**5. Communicate Decision** (if applicable)
   - Email approved applicants
   - Thank rejected applicants (optional)

### Decision Criteria

**Approve If**:
- Clear values alignment
- Understanding of participation/working camp
- Thoughtful, genuine responses
- Capacity exists in camp

**Reject If**:
- Values misalignment
- Expectation of "hotel" experience
- Responses indicate poor fit
- Capacity constraints

**When In Doubt**:
- Discuss with other reviewers
- Use Internal Notes to capture discussion
- Can leave as "Pending" for further review

## Data Privacy & Security

### Best Practices

1. **Access Control**
   - Limit sheet access to camp leadership only
   - Use "View only" for anyone who needs to see but not edit
   - Never share publicly

2. **Confidentiality**
   - Treat all submissions as confidential
   - Internal Notes should be respectful
   - Don't share rejection reasons publicly

3. **Data Retention**
   - Keep data for current season + 1 year
   - Archive old years to separate sheets
   - Delete very old data (3+ years) if not needed

4. **Email Privacy**
   - Don't share email addresses with third parties
   - Use BCC when emailing multiple applicants
   - Respect opt-outs

## Statistics & Reporting

### Useful Queries

**Total Submissions**:
```
=COUNTA(SOI_Staging!A:A) - 1
```

**Pending Count**:
```
=COUNTIF(SOI_Staging!P:P,"Pending")
```

**Approved Count**:
```
=COUNTIF(SOI_Staging!P:P,"Approved")
```

**Rejected Count**:
```
=COUNTIF(SOI_Staging!P:P,"Rejected")
```

**Approval Rate**:
```
=COUNTIF(SOI_Staging!P:P,"Approved") / (COUNTIF(SOI_Staging!P:P,"Approved") + COUNTIF(SOI_Staging!P:P,"Rejected"))
```

### Dashboard (Optional)

Create a separate "Dashboard" tab with:
- Summary statistics
- Charts showing submission trends over time
- Geographic distribution
- How people heard about RA

## Troubleshooting

### Submissions not appearing
- Check Apps Script execution logs
- Verify script permissions
- Test script with manual POST request
- Check "Who has access" is set to "Anyone"

### Duplicate submissions
- Use Conditional Formatting to highlight duplicate emails
- Formula: `=COUNTIF($D:$D,$D2)>1` (assuming email is column D)
- Review duplicate carefully - may be intentional update

### Script permission errors
- Re-authorize the script
- Check "Execute as" is set to your account
- Verify you have edit access to the sheet

## Maintenance

### Weekly
- Review new Pending submissions
- Process approved/rejected entries
- Check for issues or questions in submissions

### Monthly
- Generate statistics report
- Review approval rates and trends
- Backup sheet (File → Make a copy)

### End of Season
- Copy all data to SOI_2026 archive tab
- Generate final statistics
- Clean up SOI_Staging, SOI_Approved, SOI_Rejected for next year
- Update year references in script and form

## Support

For questions about Google Sheets setup:
1. Check this documentation
2. Review Apps Script logs for errors
3. Test with manual submissions
4. Contact RA technical team

