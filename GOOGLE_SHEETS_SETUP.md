# Google Sheets Setup for Rubber Armstrong 2026

This document describes the Google Sheets structure required for the Statement of Intent (SOI) form submissions and approval workflow.

## Overview

The Google Sheets workbook serves as the database for all SOI submissions. It tracks submissions through a manual review process from initial submission to approval/rejection.

## Sheet Tabs Required

Create a Google Sheet with the following four tabs:

1. **SOI_Staging** - All new submissions (default Status: "Pending")
2. **SOI_Approved** - Approved applicants
3. **SOI_Rejected** - Rejected applicants
4. **SOI_2026** - End-of-season archive

## Column Structure

All tabs should have the same column structure for consistency.

### Column Order and Names

| # | Column Name | Type | Description |
|---|------------|------|-------------|
| 1 | Timestamp | DateTime | Auto-generated by Apps Script when form is submitted |
| 2 | First Name | Text | Applicant's first name (auto-capitalized) |
| 3 | Last Name | Text | Applicant's last name (auto-capitalized) |
| 4 | Sex | Choice | Male / Female / Non-binary / Other |
| 5 | Birth Year | Number | Year of birth (1940-2010) |
| 6 | Country of Birth | Text | Country where applicant was born |
| 7 | Country of Residence | Text | Country where applicant currently resides |
| 8 | Email | Email | Primary contact email (lowercase) |
| 9 | Phone Country Code | Text | Phone dial code (e.g., +1, +44) |
| 10 | Phone Number | Text | Phone number without leading zeros |
| 11 | Referring Camp Mate | Text | Name of RA member who referred applicant |
| 12 | Burns with RA | Text | Comma-separated years camped with RA (e.g., "2015,2016,2017") |
| 13 | Burns without RA | Text | Comma-separated years at Burning Man not with RA |
| 14 | First Burn | Text | Yes / No (indicates if this is their first Burning Man) |
| 15 | Likelihood of Attending | Choice | Hell yeah! / Probably / Keep me in the loop |
| 16 | Steward Ticket Interest | Choice | Yes / No |
| 17 | What You Offer | Long Text | What they can offer the camp this year |
| 18 | Notes | Long Text | Notes they want us to know about this year |
| 19 | Status | Text | Pending / Approved / Rejected |
| 20 | Reviewed By | Text | Name of person who reviewed (manual) |
| 21 | Reviewed At | DateTime | Date/time of review (manual) |
| 22 | Internal Notes | Long Text | Private notes about applicant (manual) |
| 23 | Form Name | Text | Always "Statement of Intent 2026" |

### Column Formatting

**Header Row (Row 1)**:
- Bold text
- Background color: Light gray (#f3f3f3)
- Frozen (freeze first row for scrolling)

**Data Validation**:
- **Status** (Column 19): Data validation dropdown with values: "Pending", "Approved", "Rejected"
- **Sex** (Column 4): Data validation dropdown with values: "Male", "Female", "Non-binary", "Other"
- **First Burn** (Column 14): Data validation dropdown with values: "Yes", "No"
- **Likelihood of Attending** (Column 15): Data validation dropdown with values: "Hell yeah!", "Probably", "Keep me in the loop"
- **Steward Ticket Interest** (Column 16): Data validation dropdown with values: "Yes", "No"

**Conditional Formatting**:
- Status = "Pending": Light yellow background (#fff3cd)
- Status = "Approved": Light green background (#d4edda)
- Status = "Rejected": Light red background (#f8d7da)

## Tab Descriptions

### 1. SOI_Staging

**Purpose**: All form submissions land here with Status = "Pending"

**Workflow**:
1. New submissions automatically added by Apps Script
2. Review team regularly checks this tab
3. For each entry:
   - Read through responses
   - Update Status to "Approved" or "Rejected"
   - Add Reviewed By (your name)
   - Add Reviewed At (current date/time)
   - Optionally add Internal Notes
4. Copy entire row to SOI_Approved or SOI_Rejected tab
5. Leave original row in SOI_Staging for record-keeping

**Filtering**:
- Create filter view showing only Status = "Pending"
- Sort by Timestamp (oldest first) to review in order

### 2. SOI_Approved

**Purpose**: Clean list of approved applicants

**Workflow**:
1. Manually copy approved rows from SOI_Staging
2. This tab represents current approved applicants
3. Use this list to:
   - Send "I Want to Join" form links (after ticket sales)
   - Track approved applicants
   - Generate statistics

**Notes**:
- Only entries with Status = "Approved"
- Copy entire row including all review metadata

### 3. SOI_Rejected

**Purpose**: Record of declined applicants

**Workflow**:
1. Manually copy rejected rows from SOI_Staging
2. Helps avoid re-reviewing if someone submits multiple times
3. Provides record for questions or appeals

**Notes**:
- Only entries with Status = "Rejected"
- Keep Internal Notes respectful and constructive
- This data should be kept confidential

### 4. SOI_2026

**Purpose**: End-of-season archive of all 2026 submissions

**Workflow**:
1. At end of season (Sept/Oct 2026):
   - Copy all rows from SOI_Staging
   - Copy all rows from SOI_Approved (if not already in Staging)
   - Copy all rows from SOI_Rejected (if not already in Staging)
2. This creates a complete historical record
3. Can be used for year-over-year comparisons

**Notes**:
- Only populated at end of season
- Complete archive of all submissions regardless of status

## Google Apps Script Setup

### Script Purpose
Receives POST requests from the SOI form and writes data to SOI_Staging sheet.

### Script Code (Example)

```javascript
function doPost(e) {
  try {
    // Parse incoming JSON
    const data = JSON.parse(e.postData.contents);
    
    // Open the spreadsheet and get SOI_Staging sheet
    const ss = SpreadsheetApp.getActiveSpreadsheet();
    const sheet = ss.getSheetByName('SOI_Staging');
    
    // Prepare row data (must match column order - 22 columns)
    const row = [
      new Date(),                              // 1. Timestamp
      data.firstName || '',                     // 2. First Name
      data.lastName || '',                      // 3. Last Name
      data.sex || '',                           // 4. Sex
      data.birthYear || '',                     // 5. Birth Year
      data.countryOfBirth || '',                // 6. Country of Birth
      data.countryOfResidence || '',            // 7. Country of Residence
      data.email || '',                         // 8. Email
      data.phoneCountryCode || '',              // 9. Phone Country Code
      data.phoneNumber || '',                   // 10. Phone Number
      data.referringCampmate || '',             // 11. Referring Camp Mate
      data.burnsWithRA || '',                   // 12. Burns with RA
      data.burnsWithoutRA || '',                // 13. Burns without RA
      data.firstBurn || 'No',                   // 14. First Burn
      data.likelihoodOfAttending || '',         // 15. Likelihood of Attending
      data.stewardTicketInterest || '',         // 16. Steward Ticket Interest
      data.whatYouOffer || '',                  // 17. What You Offer
      data.notes || '',                         // 18. Notes
      'Pending',                                // 19. Status (default)
      '',                                       // 20. Reviewed By (empty initially)
      '',                                       // 21. Reviewed At (empty initially)
      '',                                       // 22. Internal Notes (empty initially)
      data.formName || 'Statement of Intent 2026'  // 22. Form Name
    ];
    
    // Append row to sheet
    sheet.appendRow(row);
    
    // Return success response
    return ContentService
      .createTextOutput(JSON.stringify({ 
        status: 'success',
        success: true,
        message: 'Submission received'
      }))
      .setMimeType(ContentService.MimeType.JSON);
      
  } catch (error) {
    // Return error response
    return ContentService
      .createTextOutput(JSON.stringify({ 
        status: 'error',
        success: false,
        message: error.toString()
      }))
      .setMimeType(ContentService.MimeType.JSON);
  }
}
```

### Script Deployment

1. Open your Google Sheet
2. Go to **Extensions → Apps Script**
3. Delete any existing code
4. Paste the script above
5. Modify field mappings if your form fields differ
6. Click **Deploy → New Deployment**
7. Select **Web app** as deployment type
8. Settings:
   - **Execute as**: Me (your account)
   - **Who has access**: Anyone
9. Click **Deploy**
10. Copy the web app URL
11. Update `soi-site/js/config.js` with this URL

### Testing the Script

1. Use Postman or curl to send test POST request:
```bash
curl -X POST "YOUR_SCRIPT_URL" \
  -H "Content-Type: application/json" \
  -d '{"firstName":"Test","lastName":"User","sex":"other","birthYear":"1990","countryOfBirth":"United States","countryOfResidence":"United States","email":"test@example.com","phoneCountryCode":"+1","phoneNumber":"5551234567","referringCampmate":"Jane Doe","burnsWithRA":"2023,2024","burnsWithoutRA":"2015,2016","likelihoodOfAttending":"committed","stewardTicketInterest":"yes","whatYouOffer":"Testing the form","notes":"This is a test submission","status":"Pending"}'
```

2. Check SOI_Staging tab for new row
3. Verify all fields populated correctly (23 columns)

## Google Contacts Integration

The form data structure is compatible with Google Contacts import via CSV export:

**Key fields for Google Contacts:**
- **First Name** → Given Name
- **Last Name** → Family Name
- **Email** → Email 1 - Value
- **Phone Country Code + Phone Number** → Phone 1 - Value (combine as: +1 5551234567)
- **Notes** → Notes field

**To import to Google Contacts:**
1. Export SOI_Approved tab as CSV
2. Use Google Sheets IMPORTRANGE or export directly
3. Create a column combining: `phoneCountryCode & phoneNumber` (e.g., "+15551234567")
4. Import CSV to Google Contacts
5. Map columns during import
6. Add label "2026 Rubbers" in bulk after import

**Recommended CSV column mapping:**
- Column B (First Name) → Given Name
- Column C (Last Name) → Family Name  
- Column H (Email) → Email 1 - Value
- Combined Phone → Phone 1 - Value (format: +15551234567)
- Column F (Country of Residence) → Address 1 - Country

## Manual Approval Workflow

### Step-by-Step Process

**1. Open SOI_Staging Tab**
   - Filter to show Status = "Pending"
   - Sort by Timestamp (oldest first)

**2. Review Each Submission**
   - Read all text responses carefully
   - Consider:
     - Values alignment (most important)
     - Understanding of working camp concept
     - Thoughtfulness of responses
     - Fit with RA community culture
   - Make decision: Approve or Reject

**3. Update Status**
   - Change Status column to "Approved" or "Rejected"
   - Enter your name in Reviewed By
   - Enter current date/time in Reviewed At
   - Add Internal Notes if needed

**4. Copy to Appropriate Tab**
   - **If Approved**: Copy entire row to SOI_Approved tab
   - **If Rejected**: Copy entire row to SOI_Rejected tab
   - Keep original row in SOI_Staging

**5. Communicate Decision** (if applicable)
   - Email approved applicants
   - Thank rejected applicants (optional)

### Decision Criteria

**Approve If**:
- Clear values alignment
- Understanding of participation/working camp
- Thoughtful, genuine responses
- Capacity exists in camp

**Reject If**:
- Values misalignment
- Expectation of "hotel" experience
- Responses indicate poor fit
- Capacity constraints

**When In Doubt**:
- Discuss with other reviewers
- Use Internal Notes to capture discussion
- Can leave as "Pending" for further review

## Data Privacy & Security

### Best Practices

1. **Access Control**
   - Limit sheet access to camp leadership only
   - Use "View only" for anyone who needs to see but not edit
   - Never share publicly

2. **Confidentiality**
   - Treat all submissions as confidential
   - Internal Notes should be respectful
   - Don't share rejection reasons publicly

3. **Data Retention**
   - Keep data for current season + 1 year
   - Archive old years to separate sheets
   - Delete very old data (3+ years) if not needed

4. **Email Privacy**
   - Don't share email addresses with third parties
   - Use BCC when emailing multiple applicants
   - Respect opt-outs

## Statistics & Reporting

### Useful Queries

**Total Submissions**:
```
=COUNTA(SOI_Staging!A:A) - 1
```

**Pending Count**:
```
=COUNTIF(SOI_Staging!P:P,"Pending")
```

**Approved Count**:
```
=COUNTIF(SOI_Staging!P:P,"Approved")
```

**Rejected Count**:
```
=COUNTIF(SOI_Staging!P:P,"Rejected")
```

**Approval Rate**:
```
=COUNTIF(SOI_Staging!P:P,"Approved") / (COUNTIF(SOI_Staging!P:P,"Approved") + COUNTIF(SOI_Staging!P:P,"Rejected"))
```

### Dashboard (Optional)

Create a separate "Dashboard" tab with:
- Summary statistics
- Charts showing submission trends over time
- Geographic distribution
- How people heard about RA

## Troubleshooting

### Submissions not appearing
- Check Apps Script execution logs
- Verify script permissions
- Test script with manual POST request
- Check "Who has access" is set to "Anyone"

### Duplicate submissions
- Use Conditional Formatting to highlight duplicate emails
- Formula: `=COUNTIF($D:$D,$D2)>1` (assuming email is column D)
- Review duplicate carefully - may be intentional update

### Script permission errors
- Re-authorize the script
- Check "Execute as" is set to your account
- Verify you have edit access to the sheet

## Maintenance

### Weekly
- Review new Pending submissions
- Process approved/rejected entries
- Check for issues or questions in submissions

### Monthly
- Generate statistics report
- Review approval rates and trends
- Backup sheet (File → Make a copy)

### End of Season
- Copy all data to SOI_2026 archive tab
- Generate final statistics
- Clean up SOI_Staging, SOI_Approved, SOI_Rejected for next year
- Update year references in script and form

## Support

For questions about Google Sheets setup:
1. Check this documentation
2. Review Apps Script logs for errors
3. Test with manual submissions
4. Contact RA technical team

